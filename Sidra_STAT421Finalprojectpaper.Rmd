---
title: "Sidra_STAT421_FinalProjectPaper"
author: "Sidra Sohail"
date: "12/11/2021"
output: html_document
---

### Introduction

#####  This past year, the Covid-19 pandemic has caused massive shutdown at a global scale, and the outcomes were not expected to be at this high of a magnitude. Estimating or simulating the severity of a disease outbreak is crucial to understanding what mechanisms and regulations need to be in place to curtail the outbreak. In this paper, various disease outbreaks will be simulated to estimate peaks of those outbreaks and to model how outbreaks can vary depending on how much the disease is infectious, deadly, or transmissible. The different scenarios of disease outbreaks will be simulated using variations of the SIR model (The SIR Model for Spread of Disease - The Differential Equation Model. (2004)), and the results will be modeled to identify different peaks in the SIR models for different outbreak scenarios. This simulation does not take into account cautionary measures, travel restrictions, mask mandates, or any other regulations that could curtail the outbreak.

### Methods

#####  The SIR model being implemented is Susceptible, Infected, and Recovered, and the peak of the infection rate is of interest here. This serves as a baseline model where different outbreak situations are modeled by changing the alpha and beta probabilities, such that there is a low infection rate with a low recovery rate, a high infection rate with high recovery, a high infection rate with low recovery, and low infection rate with high recovery. The alpha parameter is the probability that a susceptible person will transition to being infected. The beta parameter is the probability that an infected person will transition to being recovered. The baseline SIR model will visualize these four situations where number of days will be on the x-axis and number of people will be on the y-axis. The S, I, and R variables will be plotted and will display the peak of the outbreak and also display when the peak subsides or plateaus.
  
#####  Additionally, the SIRRS model being implemented is Susceptible, Infected, Recovered, and Recovered back to Susceptible. This model looks at the number of people in S, I, R, and also looks at how many recovered people can become susceptible again. The alpha parameter is the probability that a susceptible person will transition to being infected. The beta parameter is the probability that an infected person will transition to being recovered. The rs parameter is the probability that a recovered person will transition to being susceptible again. There will be four different outbreak scenarios modeled through the SIRRS model, which are mild, only contagious, dangermild, and danger. The mild outbreak is where the disease is slightly contagious with little symptoms, only contagious is where the disease is extremely contagious with little symptoms, dangermild is where the disease is slightly contagious with fatal symptoms, and danger is where the disease is extremely contagious with fatal symptoms. The SIRRS model will visualize these four scenarios where number of days will be on the x-axis and number of people will be on the y-axis. The S, I, and R variables will be plotted and will display the peak of the outbreak and also display when the peak subsides or plateaus. The R and RS variables will be plotted separately for each scenario to compare how many recovered people will transition to being susceptible again.
	
#####  The SID model being implemented is Susceptible, Infected, and Death. This model looks at the number of people in S, I, and D. The alpha parameter is the probability that a susceptible person will transition to being infected. The beta parameter is the probability that an infected person will transition to being recovered. The d parameter is the probability that an infected person will transition to death. There will be four different outbreak scenarios modeled through the SID model, which are mild, only contagious, dangermild, and danger. The mild outbreak is where the disease is slightly contagious with little symptoms, only contagious is where the disease is extremely contagious with little symptoms, dangermild is where the disease is slightly contagious with fatal symptoms, and danger is where the disease is extremely contagious with fatal symptoms. The SID model will visualize these four scenarios where number of days will be on the x-axis and number of people will be on the y-axis. The S, I, and D variables will be plotted and will display the peak of the outbreak and also display when the peak subsides or plateaus. The peaks of the I and D variables will be of interest here.

### Results
```{r,echo=FALSE}
### NOT CONTAGIOUS AND FATAL

N <- 1000000

# Not Contagious and Fatal
# low infection rate and low recovery
# # Prob S to I
alpha <- 0.0006
# # Prob I to R
beta <- 0.0005

SIR <- function(alpha,beta,N) {
  
  suscept <- list() # list with SIR
  suscept$S[1] <- N - 1
  suscept$I[1] <- 1
  suscept$R[1] <- 0
  t_1 <- 1
  
  while (suscept$R[t_1] < N) {
    suscept$S[t_1 + 1] <- rbinom(1, suscept$S[t_1], (1 - alpha)^(suscept$I[t_1]))
    suscept$R[t_1 + 1] <- suscept$R[t_1] + rbinom(1, suscept$I[t_1], beta)
    suscept$I[t_1 + 1] <- N - suscept$S[t_1 + 1] - suscept$R[t_1 + 1]
    torf <- suscept$S + suscept$I + suscept$R == N
    t_1 <- t_1 + 1
  }
  return(list(sir = suscept, tf = torf))
}

library(ggplot2)

set.seed(1234)
ans <- SIR(alpha,beta,N)
ans1 <- data.frame(ans[1])
ans1$Num <- 1:length(ans1$sir.S)
ggplot(ans1, aes(x = Num),) + 
  geom_line(ans1, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ans1, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ans1, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.1a: SIR Model - Not Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), axis.title.x = element_text(size = 12), 
        axis.text.x = element_text(size = 12), axis.title.y = element_text(size = 12), 
        axis.text.y = element_text(size = 12), title = element_text(size = 12))
```

Fig.1a: The "SIR Model - Not Contagious - Fatal" figure displays results from running the baseline SIR model where the alpha and beta parameters are set to values that mimic a noncontagious yet fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and recovered from 0 to 30000 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is a sharp increase of the infected population between 0 and 10000 days, where the increase is upto 1000000 people which then decreases and plateaus around 0 people at 10000 days. The susceptible population is shown to rapidly decrease where conversely the infected population is shown to quickly increase between 0 and 5000 days. The recovered population increases at a slower rate than the infected population, but soon plateaus around 1000000 people at 10000 days. Based on this simulated graph, this disease outbreak tends to subside at about 10000 days or 27 years.

``` {r, echo = FALSE}
### CONTAGIOUS AND NOT FATAL

N <- 1000000

# Contagious and Not Fatal 
# high infection rate and high recovery
# # Prob S to I
alpha2 <- 0.2
# # Prob I to R
beta2 <- 0.5


SIR <- function(alpha,beta,N) {
  
  suscept <- list() # list with SIR
  suscept$S[1] <- N - 1
  suscept$I[1] <- 1
  suscept$R[1] <- 0
  t_1 <- 1
  
  while (suscept$R[t_1] < N) {
    suscept$S[t_1 + 1] <- rbinom(1, suscept$S[t_1], (1 - alpha)^(suscept$I[t_1]))
    suscept$R[t_1 + 1] <- suscept$R[t_1] + rbinom(1, suscept$I[t_1], beta)
    suscept$I[t_1 + 1] <- N - suscept$S[t_1 + 1] - suscept$R[t_1 + 1]
    torf <- suscept$S + suscept$I + suscept$R == N
    t_1 <- t_1 + 1
  }
  return(list(sir = suscept, tf = torf))
}

set.seed(1234)
ans2 <- SIR(alpha2,beta2,N)
ans12 <- data.frame(ans2[1])
ans12$Num <- 1:length(ans12$sir.S)
ggplot(ans12, aes(x = Num)) + 
  geom_line(ans12, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ans12, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ans12, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.1b: SIR Model - Contagious - Not Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), axis.title.x = element_text(size = 12), 
        axis.text.x = element_text(size = 12), axis.title.y = element_text(size = 12), 
        axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.1b: The "SIR Model - Contagious - Not Fatal" figure displays results from running the baseline SIR model where the alpha and beta parameters are set to values that mimic a contagious yet not fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and recovered from 0 to 20 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is a rapid increase of the infected population between 0 and 3 days, where the increase is upto 880000 people which then gradually decreases and plateaus around 0 people at 10 days. The susceptible population decreases rapidly between 0 and 3 days where conversely the infected population is shown to quickly increase in that time frame. The recovered population increases at a slower rate than the infected population, but soon starts to plateau around 1000000 people at 10 days. Based on this simulated graph, this disease outbreak tends to subside at about 15 days.

``` {r, echo = FALSE}
### CONTAGIOUS AND FATAL

N <- 1000000

# Contagious and Fatal
# high infection rate and low recovery
# # Prob S to I
alpha3 <- 0.7
# # Prob I to R
beta3 <- 0.01


SIR <- function(alpha,beta,N) {
  
  suscept <- list() # list with SIR
  suscept$S[1] <- N - 1
  suscept$I[1] <- 1
  suscept$R[1] <- 0
  t_1 <- 1
  
  while (suscept$R[t_1] < N) {
    suscept$S[t_1 + 1] <- rbinom(1, suscept$S[t_1], (1 - alpha)^(suscept$I[t_1]))
    suscept$R[t_1 + 1] <- suscept$R[t_1] + rbinom(1, suscept$I[t_1], beta)
    suscept$I[t_1 + 1] <- N - suscept$S[t_1 + 1] - suscept$R[t_1 + 1]
    torf <- suscept$S + suscept$I + suscept$R == N
    t_1 <- t_1 + 1
  }
  return(list(sir = suscept, tf = torf))
}

set.seed(1234)
ans3 <- SIR(alpha3,beta3,N)
ans13 <- data.frame(ans3[1])
ans13$Num <- 1:length(ans13$sir.S)
ggplot(ans13, aes(x = Num)) + 
  geom_line(ans13, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ans13, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ans13, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.1c: SIR Model - Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.1c: The "SIR Model - Contagious - Fatal" figure displays results from running the baseline SIR model where the alpha and beta parameters are set to values that mimic a contagious and fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and recovered from 0 to 1500 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is a rapid increase of the infected population between 0 and 250 days, where the increase is upto 1000000 people which then gradually decreases and plateaus around 0 people at 500 days. The susceptible population decreases rapidly between 0 and 250 days where conversely the infected population is shown to quickly increase in that time frame. The recovered population increases at a slower rate than the infected population, but soon plateaus around 1000000 people at 500 days. Based on this simulated graph, this disease outbreak tends to subside at about 1000 days or 2.5 years.

```{r, echo = FALSE}
### MILD

N <- 1000000

# Mild - Not Contagious and Not Fatal
# low infection rate and high recovery
# # Prob S to I
alpha4 <- 0.02
# # Prob I to R
beta4 <- 0.8


SIR <- function(alpha,beta,N) {
  
  suscept <- list() # list with SIR
  suscept$S[1] <- N - 1
  suscept$I[1] <- 1
  suscept$R[1] <- 0
  t_1 <- 1
  
  while (suscept$R[t_1] < N) {
    suscept$S[t_1 + 1] <- rbinom(1, suscept$S[t_1], (1 - alpha)^(suscept$I[t_1]))
    suscept$R[t_1 + 1] <- suscept$R[t_1] + rbinom(1, suscept$I[t_1], beta)
    suscept$I[t_1 + 1] <- N - suscept$S[t_1 + 1] - suscept$R[t_1 + 1]
    torf <- suscept$S + suscept$I + suscept$R == N
    t_1 <- t_1 + 1
  }
  return(list(sir = suscept, tf = torf))
}
set.seed(1234)
ans4 <- SIR(alpha4,beta4,N)
ans14 <- data.frame(ans4[1])
ans14$Num <- 1:length(ans14$sir.S)
ggplot(ans14, aes(x = Num)) + 
  geom_line(ans14, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ans14, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ans14, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.1d: SIR Model - Mild") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), axis.title.y = element_text(size = 12), 
        axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.1d: The "SIR Model - Mild" figure displays results from running the baseline SIR model where the alpha and beta parameters are set to values that mimic a mild disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and recovered from 0 to 10 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is an increase of the infected population between 0 and 3 days, where the increase is upto 1000000 people which then gradually decreases and plateaus around 0 people at 6 days. The susceptible population decreases between 0 and 3 days where conversely the infected population is shown to increase in that time frame. The recovered population increases at a slower rate than the infected population, but soon plateaus around 1000000 people at 7 days. Based on this simulated graph, this disease outbreak tends to subside at about 10 days.**

```{r, echo = FALSE}
### MILD

SIRD <- function(alpha,beta,d,rs,N) {
  
  susceptR <- list() # list with SIRRS
  susceptR$S[1] <- N - 1
  susceptR$I[1] <- 1
  susceptR$R[1] <- 0
  susceptR$RS[1] <- 0
  t_1R <- 1
  counts <- 0
  while (susceptR$R[t_1R] < N) {
    susceptR$S[t_1R + 1] <- rbinom(1, susceptR$S[t_1R], (1 - alpha)^(susceptR$I[t_1R]))
    susceptR$R[t_1R + 1] <- susceptR$R[t_1R] + rbinom(1, susceptR$I[t_1R], beta)
    susceptR$RS[t_1R + 1] <- rbinom(1, susceptR$R[t_1R], rs)
    susceptR$I[t_1R + 1] <- N - susceptR$S[t_1R + 1] - susceptR$R[t_1R + 1]
    torfR <- susceptR$S + susceptR$I + susceptR$R == N 
    t_1R <- t_1R + 1

  }
  
  susceptD <- list() # list with SID
  susceptD$S[1] <- N - 1
  susceptD$I[1] <- 1
  susceptD$D[1] <- 0
  t_1 <- 1
  
  while (susceptD$D[t_1] < N) {
    susceptD$S[t_1 + 1] <- rbinom(1, susceptD$S[t_1], (1 - alpha)^(susceptD$I[t_1]))
    susceptD$D[t_1 + 1] <- susceptD$D[t_1] + rbinom(1, susceptD$I[t_1], d)
    susceptD$I[t_1 + 1] <- N - susceptD$S[t_1 + 1] - susceptD$D[t_1 + 1]
    torfD <- susceptD$S + susceptD$I + susceptD$D == N 
    t_1 <- t_1 + 1

  }
  return(list(sir = susceptR, sid = susceptD, t_R = t_1R, t_D = t_1))
}

# very mild disease with population of 1000000
# # mildly contagious with mild outcomes
library(ggplot2)
N <- 1000000
# # Prob S to I
alpha <- 0.0001
# # Prob I to R 
beta <- 0.09
# # Prob I to D
d <- 0.0009
# # Prob R to S
rs <- 0.05
set.seed(1234)
mild <- SIRD(alpha,beta,d,rs,N)

# SIR
mildR <- data.frame(mild[1])
mildR$Num <- 1:length(mildR$sir.S)
ggplot(mildR, aes(x = Num)) + 
  geom_line(mildR, mapping = aes(y = sir.S, color = "S")) +
  geom_line(mildR, mapping = aes(y = sir.I, color = "I")) +
  geom_line(mildR, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.2a: SIRRS Model - Mild") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12),
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.2a: The "SIRRS Model - Mild" figure displays results from running the SIRRS model where the alpha, beta, d, and rs parameters are set to values that mimic a mild disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and recovered from 0 to 150 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is an increase of the infected population between 0 and 25 days, where the increase is upto 920000 people which then gradually decreases and plateaus around 0 people at 50 days. The susceptible population decreases between 0 and 25 days where conversely the infected population is shown to increase in that time frame. The recovered population increases at a slower rate than the infected population, but soon plateaus around 1000000 people at 50 days. Based on this simulated graph, this disease outbreak tends to subside at about 100 days.

``` {r, echo = FALSE}
# RRS

# very mild disease with population of 1000000
# # mildly contagious with mild outcomes
library(ggplot2)

ggplot(mildR, aes(x = Num)) + 
  geom_line(mildR, mapping = aes(y = sir.R, color = "R")) +
  geom_line(mildR, mapping = aes(y = sir.RS, color = "RS")) +
  labs(x = "Number of Days", y = "Number of People", title = " Fig.2b: RRS Model - Mild") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.2b: The "RRS Model - Mild" figure displays results from running the SIRRS model where the alpha, beta, d, and rs parameters are set to values that mimic a mild disease outbreak. The Number of Days on the x-axis show how many people became recovered and how many people transitioned from recovered to being susceptible again from 0 to 150 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. The recovered population increases at a faster rate than the recovered-to-susceptible population, but soon plateaus around 1000000 people at 50 days. The recovered-to-susceptible population very slightly increases after 0 days but soon plateaus around 50000 people at 50 days. The disease is not very contagious as the probability of transitioning from susceptible to infectious and from recovered to susceptible is low; thus, there are fewer people that are in the recovered-to-susceptible population as compared to the recovered population.

```{r, echo = FALSE}

# SID

# very mild disease with population of 1000000
# # mildly contagious with mild outcomes
library(ggplot2)

mildD <- data.frame(mild[2])
mildD$Num <- 1:length(mildD$sid.S)
ggplot(mildD, aes(x = Num)) + 
  geom_line(mildD, mapping = aes(y = sid.S, color = "S")) +
  geom_line(mildD, mapping = aes(y = sid.I, color = "I")) +
  geom_line(mildD, mapping = aes(y = sid.D, color = "D")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.2c: SID Model - Mild") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12),
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.2c: The "SID Model - Mild" figure displays results from running the SID model where the alpha and d parameters are set to values that mimic a mild disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and death from 0 to 10000 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is an increase of the infected population between 0 and 2500 days, where the increase is upto 1000000 people which then gradually decreases and plateaus around 0 people at 5000 days. The susceptible population decreases between 0 and 2500 days where conversely the infected population is shown to increase in that time frame. The death population increases at a slower rate, but soon plateaus around 1000000 people at 5000 days. Based on this simulated graph, this disease outbreak tends to plateau at about 10000 days.

```{r, echo = FALSE}
# SIR - only contagious 
SIRD <- function(alpha,beta,d,rs,N) { # (alpha,beta,d,rs,N)
  
  susceptR <- list() # list with SIRRS
  susceptR$S[1] <- N - 1
  susceptR$I[1] <- 1
  susceptR$R[1] <- 0
  susceptR$RS[1] <- 0
  t_1R <- 1
  counts <- 0
  while (susceptR$R[t_1R] < N) {
    susceptR$S[t_1R + 1] <- rbinom(1, susceptR$S[t_1R], (1 - alpha)^(susceptR$I[t_1R]))
    susceptR$R[t_1R + 1] <- susceptR$R[t_1R] + rbinom(1, susceptR$I[t_1R], beta)
    susceptR$RS[t_1R + 1] <- rbinom(1, susceptR$R[t_1R], rs)
    susceptR$I[t_1R + 1] <- N - susceptR$S[t_1R + 1] - susceptR$R[t_1R + 1]
    torfR <- susceptR$S + susceptR$I + susceptR$R == N 
    t_1R <- t_1R + 1

  }
  
  susceptD <- list() # list with SID
  susceptD$S[1] <- N - 1
  susceptD$I[1] <- 1
  susceptD$D[1] <- 0
  t_1 <- 1
  
  while (susceptD$D[t_1] < N) {
    susceptD$S[t_1 + 1] <- rbinom(1, susceptD$S[t_1], (1 - alpha)^(susceptD$I[t_1]))
    susceptD$D[t_1 + 1] <- susceptD$D[t_1] + rbinom(1, susceptD$I[t_1], d)
    susceptD$I[t_1 + 1] <- N - susceptD$S[t_1 + 1] - susceptD$D[t_1 + 1]
    torfD <- susceptD$S + susceptD$I + susceptD$D == N 
    t_1 <- t_1 + 1

  }
  return(list(sir = susceptR, sid = susceptD, t_R = t_1R, t_D = t_1))
}

N <- 1000000
# # Prob S to I
alpha <- 0.43
# # Prob I to R 
beta <- 0.1
# # Prob I to D
d <- 0.0004
# # Prob R to S
rs <- 0.09
set.seed(1234)
onlycontagious <- SIRD(alpha,beta,d,rs,N)

ocontagR <- data.frame(onlycontagious[1])
ocontagR$Num <- 1:length(ocontagR$sir.S)

ggplot(ocontagR, aes(x = Num)) + 
  geom_line(ocontagR, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ocontagR, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ocontagR, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.3a: SIRRS Model - Contagious - Not Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.3a: The "SIRRS Model - Contagious - Not Fatal" figure displays results from running the SIRRS model where the alpha, beta, d, and rs parameters are set to values that mimic a contagious yet not fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and recovered from 0 to 150 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is a steep increase of the infected population between 0 and 25 days, where the increase is upto 920000 people which then gradually decreases and plateaus around 0 people at 50 days. The susceptible population steeply decreases between 0 and 25 days where conversely the infected population is shown to increase in that time frame. The recovered population increases at a slower rate than the infected population, but soon starts to plateau around 1000000 people at 50 days. Based on this simulated graph, this disease outbreak tends to subside at about 100 days.

```{r, echo = FALSE}
# RRS

ggplot(ocontagR, aes(x = Num)) + 
  geom_line(ocontagR, mapping = aes(y = sir.R, color = "R")) +
  geom_line(ocontagR, mapping = aes(y = sir.RS, color = "RS")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.3b: RRS Model - Contagious - Not Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.3b: The "RRS Model - Contagious - Not Fatal" figure displays results from running the SIRRS model where the alpha, beta, d, and rs parameters are set to values that mimic a contagious yet not fatal disease outbreak. The Number of Days on the x-axis show how many people became recovered and how many people transitioned from recovered to being susceptible again from 0 to 150 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. The recovered population increases at a faster rate than the recovered-to-susceptible population, but soon plateaus around 1000000 people at 50 days. The recovered-to-susceptible population increases after 0 days but soon plateaus around 90000 people at 50 days. The disease is more contagious than the mild SIRRS model disease outbreak as the recovered-to-susceptible population has plateaued at a higher point.

```{r, echo = FALSE}
# SID

ocontagD <- data.frame(onlycontagious[2])
ocontagD$Num <- 1:length(ocontagD$sid.S)
ggplot(ocontagD, aes(x = Num)) + 
  geom_line(ocontagD, mapping = aes(y = sid.S, color = "S")) +
  geom_line(ocontagD, mapping = aes(y = sid.I, color = "I")) +
  geom_line(ocontagD, mapping = aes(y = sid.D, color = "D")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.3c: SID Model - Contagious - Not Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.3c: The "SID Model - Contagious - Not Fatal" figure displays results from running the SID model where the alpha and d parameters are set to values that mimic a contagious yet not fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and death from 0 to 30000 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is a rapid increase of the infected population between 0 and 5000 days, where the increase is upto 1000000 people which then gradually decreases and plateaus around 0 people after 10000 days. The susceptible population decreases between 0 and 5000 days where conversely the infected population is shown to increase in that time frame. The death population increases at a slower rate, but soon plateaus around 1000000 people at 10000 days. Based on this simulated graph, this disease outbreak tends to plateau at about 20000 days or 54 years.

```{r, echo = FALSE}
# SIR - fatal not contagious 
SIRD <- function(alpha,beta,d,rs,N) { # (alpha,beta,d,rs,N)
  
  susceptR <- list() # list with SIRRS
  susceptR$S[1] <- N - 1
  susceptR$I[1] <- 1
  susceptR$R[1] <- 0
  susceptR$RS[1] <- 0
  t_1R <- 1
  counts <- 0
  while (susceptR$R[t_1R] < N) {
    susceptR$S[t_1R + 1] <- rbinom(1, susceptR$S[t_1R], (1 - alpha)^(susceptR$I[t_1R]))
    susceptR$R[t_1R + 1] <- susceptR$R[t_1R] + rbinom(1, susceptR$I[t_1R], beta)
    susceptR$RS[t_1R + 1] <- rbinom(1, susceptR$R[t_1R], rs)
    susceptR$I[t_1R + 1] <- N - susceptR$S[t_1R + 1] - susceptR$R[t_1R + 1]
    torfR <- susceptR$S + susceptR$I + susceptR$R == N 
    t_1R <- t_1R + 1

  }
  
  susceptD <- list() # list with SID
  susceptD$S[1] <- N - 1
  susceptD$I[1] <- 1
  susceptD$D[1] <- 0
  t_1 <- 1
  
  while (susceptD$D[t_1] < N) {
    susceptD$S[t_1 + 1] <- rbinom(1, susceptD$S[t_1], (1 - alpha)^(susceptD$I[t_1]))
    susceptD$D[t_1 + 1] <- susceptD$D[t_1] + rbinom(1, susceptD$I[t_1], d)
    susceptD$I[t_1 + 1] <- N - susceptD$S[t_1 + 1] - susceptD$D[t_1 + 1]
    torfD <- susceptD$S + susceptD$I + susceptD$D == N 
    t_1 <- t_1 + 1

  }
  return(list(sir = susceptR, sid = susceptD, t_R = t_1R, t_D = t_1))
}

N <- 1000000
# # Prob S to I
alpha <- 0.0002
# # Prob I to R 
beta <- 0.0007
# # Prob I to D
d <- 0.01
# # Prob R to S
rs <- 0.0001
set.seed(1234)
dangermild <- SIRD(alpha,beta,d,rs,N)

dmR <- data.frame(dangermild[1])
dmR$Num <- 1:length(dmR$sir.S)
ggplot(dmR, aes(x = Num)) + 
  geom_line(dmR, mapping = aes(y = sir.S, color = "S")) +
  geom_line(dmR, mapping = aes(y = sir.I, color = "I")) +
  geom_line(dmR, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.4a: SIRRS Model - Not Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.4a: The "SIRRS Model - Not Contagious - Fatal" figure displays results from running the SIRRS model where the alpha, beta, d, and rs parameters are set to values that mimic a not contagious yet fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and recovered from 0 to 17500 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is an increase of the infected population between 0 and 2500 days, where the increase is upto 1000000 people which then gradually decreases and plateaus around 0 people after 5000 days. The susceptible population decreases between 0 and 2500 days where conversely the infected population is shown to increase in that time frame. The recovered population increases at a slower rate than the infected population, but soon starts to plateau around 1000000 people after 5000 days. Based on this simulated graph, this disease outbreak tends to subside at about 10000 days.

```{r, echo = FALSE}
# RRS

ggplot(dmR, aes(x = Num)) + 
  geom_line(dmR, mapping = aes(y = sir.R, color = "R")) +
  geom_line(dmR, mapping = aes(y = sir.RS, color = "RS")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.4b: RRS Model - Not Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.4b: The "RRS Model - Not Contagious - Fatal" figure displays results from running the SIRRS model where the alpha, beta, d, and rs parameters are set to values that mimic a not contagious yet fatal disease outbreak. The Number of Days on the x-axis show how many people became recovered and how many people transitioned from recovered to being susceptible again from 0 to 15000 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. The recovered population increases at a faster rate than the recovered-to-susceptible population, but soon plateaus around 1000000 people after 5000 days. The recovered-to-susceptible population increases very slightly after 0 days but soon plateaus around 50 people after 2500 days. The disease is not a contagious disease outbreak, as the recovered-to-susceptible population is extremely low with a population of at most 50 people.

```{r, echo = FALSE}
#SID

dmD <- data.frame(dangermild[2])
dmD$Num <- 1:length(dmD$sid.S)
ggplot(dmD, aes(x = Num)) + 
  geom_line(dmD, mapping = aes(y = sid.S, color = "S")) +
  geom_line(dmD, mapping = aes(y = sid.I, color = "I")) +
  geom_line(dmD, mapping = aes(y = sid.D, color = "D")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.4c: SID Model - Not Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.4c: The "SID Model - Not Contagious - Fatal" figure displays results from running the SID model where the alpha and d parameters are set to values that mimic a not contagious yet fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and death from 0 to 1500 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is an increase of the infected population between 0 and 250 days, where the increase is upto 1000000 people which then gradually decreases and plateaus around 0 people after 500 days. The susceptible population decreases between 0 and 250 days where conversely the infected population is shown to increase in that time frame. The death population increases at a slower rate, but soon plateaus around 1000000 people after 500 days. Based on this simulated graph, this disease outbreak tends to plateau at about 1000 days or 3 years.

```{r, echo = FALSE}
# SIR = contagious fatal
SIRD <- function(alpha,beta,d,rs,N) { # (alpha,beta,d,rs,N)
  
  susceptR <- list() # list with SIRRS
  susceptR$S[1] <- N - 1
  susceptR$I[1] <- 1
  susceptR$R[1] <- 0
  susceptR$RS[1] <- 0
  t_1R <- 1
  counts <- 0
  while (susceptR$R[t_1R] < N) {
    susceptR$S[t_1R + 1] <- rbinom(1, susceptR$S[t_1R], (1 - alpha)^(susceptR$I[t_1R]))
    susceptR$R[t_1R + 1] <- susceptR$R[t_1R] + rbinom(1, susceptR$I[t_1R], beta)
    susceptR$RS[t_1R + 1] <- rbinom(1, susceptR$R[t_1R], rs)
    susceptR$I[t_1R + 1] <- N - susceptR$S[t_1R + 1] - susceptR$R[t_1R + 1]
    torfR <- susceptR$S + susceptR$I + susceptR$R == N 
    t_1R <- t_1R + 1

  }
  
  susceptD <- list() # list with SID
  susceptD$S[1] <- N - 1
  susceptD$I[1] <- 1
  susceptD$D[1] <- 0
  t_1 <- 1
  
  while (susceptD$D[t_1] < N) {
    susceptD$S[t_1 + 1] <- rbinom(1, susceptD$S[t_1], (1 - alpha)^(susceptD$I[t_1]))
    susceptD$D[t_1 + 1] <- susceptD$D[t_1] + rbinom(1, susceptD$I[t_1], d)
    susceptD$I[t_1 + 1] <- N - susceptD$S[t_1 + 1] - susceptD$D[t_1 + 1]
    torfD <- susceptD$S + susceptD$I + susceptD$D == N 
    t_1 <- t_1 + 1

  }
  return(list(sir = susceptR, sid = susceptD, t_R = t_1R, t_D = t_1))
}

# very contagious with fatal outcomes with population of 1000000
N <- 1000000
# # Prob S to I
alpha <- 0.2
# # Prob I to R 
beta <- 0.00055
# # Prob I to D
d <- 0.25
# # Prob R to S
rs <- 0.22
set.seed(1234)
danger <- SIRD(alpha,beta,d,rs,N)

dangerR <- data.frame(danger[1])
dangerR$Num <- 1:length(dangerR$sir.S)
ggplot(dangerR, aes(x = Num)) + 
  geom_line(dangerR, mapping = aes(y = sir.S, color = "S")) +
  geom_line(dangerR, mapping = aes(y = sir.I, color = "I")) +
  geom_line(dangerR, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.5a: SIRRS Model - Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.5a: The "SIRRS Model - Contagious - Fatal" figure displays results from running the SIRRS model where the alpha, beta, d, and rs parameters are set to values that mimic a contagious and fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and recovered from 0 to 20000 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is sharp increase of the infected population between 0 and 2500 days, where the increase is upto 1000000 people which then decreases and plateaus around 0 people at 10000 days. The susceptible population decreases between 0 and 2500 days where conversely the infected population is shown to increase in that time frame. The recovered population increases at a slower rate than the infected population, but soon starts to plateau around 1000000 people at 10000 days. Based on this simulated graph, this disease outbreak tends to subside at about 15000 days or 41 years.

```{r, echo = FALSE}
# RRS

ggplot(dangerR, aes(x = Num)) + 
  geom_line(dangerR, mapping = aes(y = sir.R, color = "R")) +
  geom_line(dangerR, mapping = aes(y = sir.RS, color = "RS")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.5b: RRS Model - Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.5b: The "RRS Model - Contagious - Fatal" figure displays results from running the SIRRS model where the alpha, beta, d, and rs parameters are set to values that mimic a contagious and fatal disease outbreak. The Number of Days on the x-axis show how many people became recovered and how many people transitioned from recovered to being susceptible again from 0 to 20000 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. The recovered population increases at a faster rate than the recovered-to-susceptible population, but soon plateaus around 1000000 people at 10000 days. The recovered-to-susceptible population increases after 0 days and plateaus close to 250000 people at 10000 days. The disease is a very contagious outbreak, as the recovered-to-susceptible population increases quickly with a population close to 250000 people or a quarter of the population.

```{r, echo = FALSE}
# SID

dangerD <- data.frame(danger[2])
dangerD$Num <- 1:length(dangerD$sid.S)
ggplot(dangerD, aes(x = Num)) + 
  geom_line(dangerD, mapping = aes(y = sid.S, color = "S")) +
  geom_line(dangerD, mapping = aes(y = sid.I, color = "I")) +
  geom_line(dangerD, mapping = aes(y = sid.D, color = "D")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.5c: SID Model - Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```

Fig.5c: The "SID Model - Contagious - Fatal" figure displays results from running the SID model where the alpha and d parameters are set to values that mimic a contagious and fatal disease outbreak. The Number of Days on the x-axis show how many people become susceptible, infected, and death from 0 to 50 days. The Number of People on the y-axis show the population size from 0 to 1000000 people. There is an increase of the infected population between 0 and 5 days, where the increase is upto 930000 people which then decreases and plateaus around 0 people at 20 days. The susceptible population decreases between 0 and 5 days where conversely the infected population is shown to increase in that time frame. The death population increases at a slower rate, but soon plateaus around 1000000 people after 20 days. Based on this simulated graph, this disease outbreak tends to plateau at about 50 days.


### Conclusion

#####  The SIR, SIRRS, and SID model simulations output results for four different disease outbreak scenarios. The S, I, R, RS, and D variables were visualized through graphs to identify peaks and plateaus where the Number of Days were on the x-axis and Number of People were on the y-axis. The four different disease outbreaks of interest were mild, contagious but not fatal, not contagious but fatal, and contagious but fatal. The alpha, beta, rs, and d parameters were changed to correspond to a disease state. The alpha parameter is set to be the probability of a susceptible person becoming infected. The beta parameter is set to be the probability of an infected person becoming recovered. The rs parameter is set to be the probability of a recovered person becoming susceptible again. The d parameter is set to be the probability of an infected person becoming death. The SIR model serves as a baseline model as it only looks at the S, I, and R variables with the alpha and beta parameters as the input probabilities. The SIRRS model looks at the SIR model along with comparing the R variable with the RS variable with alpha, beta, and rs parameters as the input probabilities. The SID model looks at the S, I, and D variables with the alpha and d parameters as the input probabilities.

#####  The baseline SIR model graph for the not contagious but fatal disease outbreak extends to 20000 days, due to the fact that the disease is not contagious and is fatal. Since the disease is fatal and does not spread as quickly, the recovered population takes a very long time recover to 1000000 people. The contagious but not fatal disease outbreak extends to 20 days, due to the fact that the disease spreads quickly and is not fatal. The recovered population recovers to 1000000 people at a fast rate and also the disease spreads quickly. The contagious but fatal disease outbreak extends to 1500 days. This outbreak scenario is similar to the not contagious but fatal disease state as this outbreak also takes a relatively long time to recover to 1000000 people. However, due to the disease being contagious and spreading more easily, the outbreak is not as long as the not contagious but fatal outbreak. The mild outbreak extends to 11 days, similar of a time frame as the contagious not fatal outbreak. Since this disease outbreak is not as contagious nor is it fatal, the timespan of this disease outbreak is very short.

#####  The SIRRS model graph for the mild disease outbreak extends to 150 days as it is not contagious nor is it fatal. The graph plateaus after 50 days and continues to plateau until 150 days and follows a similar trend to that of the SIR model for the mild disease outbreak. Since this disease outbreak is not contagious nor fatal, there are very few recovered people that become susceptible again as shown through the RRS model for the mild disease outbreak. Conversely to the SIRRS model, the SID model extends to 15000 days as this is a mild outbreak the number of deaths should remain low for a long time. It is not until after 5000 days or 13 years that the SID model begins to approach 1000000 people. The results of the SIRRS, RRS, and SID models for this disease outbreak are in line with a mild outbreak.

#####  The SIRRS model for the contagious but not fatal disease outbreak extends to 100 days, as this infectious disease spreads quickly. Since it is not fatal, the recovery time is fast and plateaus quickly at 1000000 people after 50 days. Similarly, the RRS model for this disease state shows fewer recovered people becoming susceptible again. Converse to the corresponding SIRRS model, the SID model extends to 30000 days. Since this disease outbreak is not fatal, this SID model takes more than 10000 days or 27 years to begin to plateau at 1000000 people. The results of the SIRRS, RRS, and SID models for this disease outbreak are in line with a contagious but not fatal outbreak.

#####  The SIRRS model for the not contagious but fatal disease outbreak extends to 15000 days, as in this disease outbreak the population does not recover quickly. Since this disease is fatal, the recovery time is slow and plateaus at a slow pace to 1000000 people after 5000 days. Since the disease state is not contagious, the RRS model for this outbreak shows that there are very few recovered people that become susceptible again to this disease state. Conversely, the SID model quickly extends to 1000 days as this disease outbreak is fatal. Since this disease outbreak is fatal, this SID model takes 500 days or 1.5 years to plateau at 1000000 people. The results of the SIRRS, RRS, and SID models for this disease outbreak are in line with a not contagious but fatal outbreak.

#####  The SIRRS model for the contagious but fatal disease outbreak extends to 20000 days as the population does not recover quickly. Since this disease state is contagious, the RRS model for this outbreak shows that there are 250000 people or a quarter of the population that is recovered that become susceptible again to this disease. Converse to the SIRRS model of this disease state, the SID model extends quickly to 50 days. This disease is both contagious and fatal, so it is able to both spread very quickly and is equally fatal to the population, which account for the short timeframe of this disease state. The number of deaths quickly approach 1000000 people at 20 days. Additionally, the number of infected increases sharply and the number of susceptible decreases sharply. The results of the SIRRS, RRS, and SID models for this disease outbreak are in line with a contagious and fatal outbreak.


### Appendix
```{r, eval = FALSE}
# Baseline model
## SIR model with four different scenarios
# Population
N <- 1000000
# Not Contagious and Fatal
# low infection rate and low recovery
# # Prob S to I
alpha <- 0.0006
# # Prob I to R
beta <- 0.0005

# Contagious and Not Fatal 
# high infection rate and high recovery
# # Prob S to I
alpha2 <- 0.2
# # Prob I to R
beta2 <- 0.5

# Contagious and Fatal
# high infection rate and low recovery
# # Prob S to I
alpha3 <- 0.7
# # Prob I to R
beta3 <- 0.01

# Mild - Not Contagious and Not Fatal
# low infection rate and high recovery
# # Prob S to I
alpha4 <- 0.02
# # Prob I to R
beta4 <- 0.8


SIR <- function(alpha,beta,N) {
  
  suscept <- list() # list with SIR
  suscept$S[1] <- N - 1
  suscept$I[1] <- 1
  suscept$R[1] <- 0
  t_1 <- 1
  
  while (suscept$R[t_1] < N) {
    suscept$S[t_1 + 1] <- rbinom(1, suscept$S[t_1], (1 - alpha)^(suscept$I[t_1]))
    suscept$R[t_1 + 1] <- suscept$R[t_1] + rbinom(1, suscept$I[t_1], beta)
    suscept$I[t_1 + 1] <- N - suscept$S[t_1 + 1] - suscept$R[t_1 + 1]
    torf <- suscept$S + suscept$I + suscept$R == N
    t_1 <- t_1 + 1
  }
  return(list(sir = suscept, tf = torf))
}

library(ggplot2)

set.seed(1234)
ans <- SIR(alpha,beta,N)
ans1 <- data.frame(ans[1])
ans1$Num <- 1:length(ans1$sir.S)
ggplot(ans1, aes(x = Num),) + 
  geom_line(ans1, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ans1, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ans1, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.1a: SIR Model - Not Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), axis.title.x = element_text(size = 12), 
        axis.text.x = element_text(size = 12), axis.title.y = element_text(size = 12), 
        axis.text.y = element_text(size = 12), title = element_text(size = 12))

set.seed(1234)
ans2 <- SIR(alpha2,beta2,N)
ans12 <- data.frame(ans2[1])
ans12$Num <- 1:length(ans12$sir.S)
ggplot(ans12, aes(x = Num)) + 
  geom_line(ans12, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ans12, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ans12, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.1b: SIR Model - Contagious - Not Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), axis.title.x = element_text(size = 12), 
        axis.text.x = element_text(size = 12), axis.title.y = element_text(size = 12), 
        axis.text.y = element_text(size = 12), title = element_text(size = 12))

set.seed(1234)
ans3 <- SIR(alpha3,beta3,N)
ans13 <- data.frame(ans3[1])
ans13$Num <- 1:length(ans13$sir.S)
ggplot(ans13, aes(x = Num)) + 
  geom_line(ans13, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ans13, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ans13, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.1c: SIR Model - Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

set.seed(1234)
ans4 <- SIR(alpha4,beta4,N)
ans14 <- data.frame(ans4[1])
ans14$Num <- 1:length(ans14$sir.S)
ggplot(ans14, aes(x = Num)) + 
  geom_line(ans14, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ans14, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ans14, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.1d: SIR Model - Mild") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), axis.title.y = element_text(size = 12), 
        axis.text.y = element_text(size = 12), title = element_text(size = 12))


# SIRRS and SID models
# SIRRS and SID
SIRD <- function(alpha,beta,d,rs,N) { # (alpha,beta,d,rs,N)
  
  susceptR <- list() # list with SIRRS
  susceptR$S[1] <- N - 1
  susceptR$I[1] <- 1
  susceptR$R[1] <- 0
  susceptR$RS[1] <- 0
  t_1R <- 1
  counts <- 0
  while (susceptR$R[t_1R] < N) {
    susceptR$S[t_1R + 1] <- rbinom(1, susceptR$S[t_1R], (1 - alpha)^(susceptR$I[t_1R]))
    susceptR$R[t_1R + 1] <- susceptR$R[t_1R] + rbinom(1, susceptR$I[t_1R], beta)
    susceptR$RS[t_1R + 1] <- rbinom(1, susceptR$R[t_1R], rs)
    susceptR$I[t_1R + 1] <- N - susceptR$S[t_1R + 1] - susceptR$R[t_1R + 1]
    torfR <- susceptR$S + susceptR$I + susceptR$R == N 
    t_1R <- t_1R + 1
    
  }
  
  susceptD <- list() # list with SID
  susceptD$S[1] <- N - 1
  susceptD$I[1] <- 1
  susceptD$D[1] <- 0
  t_1 <- 1
  
  while (susceptD$D[t_1] < N) {
    susceptD$S[t_1 + 1] <- rbinom(1, susceptD$S[t_1], (1 - alpha)^(susceptD$I[t_1]))
    susceptD$D[t_1 + 1] <- susceptD$D[t_1] + rbinom(1, susceptD$I[t_1], d)
    susceptD$I[t_1 + 1] <- N - susceptD$S[t_1 + 1] - susceptD$D[t_1 + 1]
    torfD <- susceptD$S + susceptD$I + susceptD$D == N 
    t_1 <- t_1 + 1
    
  }
  return(list(sir = susceptR, sid = susceptD, t_R = t_1R, t_D = t_1))
}

# Four scenarios:

# very mild disease with population of 1000000
# # mildly contagious with mild outcomes
library(ggplot2)

N <- 1000000
# # Prob S to I
alpha <- 0.0001
# # Prob I to R 
beta <- 0.09
# # Prob I to D
d <- 0.0009
# # Prob R to S
rs <- 0.05

set.seed(1234)
mild <- SIRD(alpha,beta,d,rs,N)

# very contagious with mild outcomes with population of 1000000
N <- 1000000
# # Prob S to I
alpha <- 0.43
# # Prob I to R 
beta <- 0.1
# # Prob I to D
d <- 0.0004
# # Prob R to S
rs <- 0.09

set.seed(1234)
onlycontagious <- SIRD(alpha,beta,d,rs,N)

# mildly contagious with fatal outcomes with population of 1000000
N <- 1000000
# # Prob S to I
alpha <- 0.0002
# # Prob I to R 
beta <- 0.0007
# # Prob I to D
d <- 0.01
# # Prob R to S
rs <- 0.0001

set.seed(1234)
dangermild <- SIRD(alpha,beta,d,rs,N)

# very contagious with fatal outcomes with population of 1000000
N <- 1000000
# # Prob S to I
alpha <- 0.2
# # Prob I to R 
beta <- 0.00055
# # Prob I to D
d <- 0.25
# # Prob R to S
rs <- 0.22

set.seed(1234)
danger <- SIRD(alpha,beta,d,rs,N)


# Plots of the four scenarios 
library(ggplot2)

# mild scenario
# SIR
mildR <- data.frame(mild[1])
mildR$Num <- 1:length(mildR$sir.S)
ggplot(mildR, aes(x = Num)) + 
  geom_line(mildR, mapping = aes(y = sir.S, color = "S")) +
  geom_line(mildR, mapping = aes(y = sir.I, color = "I")) +
  geom_line(mildR, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.2a: SIRRS Model - Mild") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12),
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

# RRS
ggplot(mildR, aes(x = Num)) + 
  geom_line(mildR, mapping = aes(y = sir.R, color = "R")) +
  geom_line(mildR, mapping = aes(y = sir.RS, color = "RS")) +
  labs(x = "Number of Days", y = "Number of People", title = " Fig.2b: RRS Model - Mild") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

# SID
mildD <- data.frame(mild[2])
mildD$Num <- 1:length(mildD$sid.S)
ggplot(mildD, aes(x = Num)) + 
  geom_line(mildD, mapping = aes(y = sid.S, color = "S")) +
  geom_line(mildD, mapping = aes(y = sid.I, color = "I")) +
  geom_line(mildD, mapping = aes(y = sid.D, color = "D")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.2c: SID Model - Mild") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))


# onlycontagious scenario
# SIR
ocontagR <- data.frame(onlycontagious[1])
ocontagR$Num <- 1:length(ocontagR$sir.S)
ggplot(ocontagR, aes(x = Num)) + 
  geom_line(ocontagR, mapping = aes(y = sir.S, color = "S")) +
  geom_line(ocontagR, mapping = aes(y = sir.I, color = "I")) +
  geom_line(ocontagR, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.3a: SIRRS Model - Contagious - Not Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

# RRS
ggplot(ocontagR, aes(x = Num)) + 
  geom_line(ocontagR, mapping = aes(y = sir.R, color = "R")) +
  geom_line(ocontagR, mapping = aes(y = sir.RS, color = "RS")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.3b: RRS Model - Contagious - Not Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

# SID
ocontagD <- data.frame(onlycontagious[2])
ocontagD$Num <- 1:length(ocontagD$sid.S)
ggplot(ocontagD, aes(x = Num)) + 
  geom_line(ocontagD, mapping = aes(y = sid.S, color = "S")) +
  geom_line(ocontagD, mapping = aes(y = sid.I, color = "I")) +
  geom_line(ocontagD, mapping = aes(y = sid.D, color = "D")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.3c: SID Model - Contagious - Not Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))


# dangermild scenario
# SIR
dmR <- data.frame(dangermild[1])
dmR$Num <- 1:length(dmR$sir.S)
ggplot(dmR, aes(x = Num)) + 
  geom_line(dmR, mapping = aes(y = sir.S, color = "S")) +
  geom_line(dmR, mapping = aes(y = sir.I, color = "I")) +
  geom_line(dmR, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.4a: SIRRS Model - Not Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

# RRS
ggplot(dmR, aes(x = Num)) + 
  geom_line(dmR, mapping = aes(y = sir.R, color = "R")) +
  geom_line(dmR, mapping = aes(y = sir.RS, color = "RS")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.4b: RRS Model - Not Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

#SID
dmD <- data.frame(dangermild[2])
dmD$Num <- 1:length(dmD$sid.S)
ggplot(dmD, aes(x = Num)) + 
  geom_line(dmD, mapping = aes(y = sid.S, color = "S")) +
  geom_line(dmD, mapping = aes(y = sid.I, color = "I")) +
  geom_line(dmD, mapping = aes(y = sid.D, color = "D")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.4c: SID Model - Not Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))


# danger scenario
# SIR
dangerR <- data.frame(danger[1])
dangerR$Num <- 1:length(dangerR$sir.S)
ggplot(dangerR, aes(x = Num)) + 
  geom_line(dangerR, mapping = aes(y = sir.S, color = "S")) +
  geom_line(dangerR, mapping = aes(y = sir.I, color = "I")) +
  geom_line(dangerR, mapping = aes(y = sir.R, color = "R")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.5a: SIRRS Model - Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

# RRS
ggplot(dangerR, aes(x = Num)) + 
  geom_line(dangerR, mapping = aes(y = sir.R, color = "R")) +
  geom_line(dangerR, mapping = aes(y = sir.RS, color = "RS")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.5b: RRS Model - Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

# SID
dangerD <- data.frame(danger[2])
dangerD$Num <- 1:length(dangerD$sid.S)
ggplot(dangerD, aes(x = Num)) + 
  geom_line(dangerD, mapping = aes(y = sid.S, color = "S")) +
  geom_line(dangerD, mapping = aes(y = sid.I, color = "I")) +
  geom_line(dangerD, mapping = aes(y = sid.D, color = "D")) +
  labs(x = "Number of Days", y = "Number of People", title = "Fig.5c: SID Model - Contagious - Fatal") +
  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 12), 
        axis.title.x = element_text(size = 12), axis.text.x = element_text(size = 12), 
        axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 12), title = element_text(size = 12))

```
